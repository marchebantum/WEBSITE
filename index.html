<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Primary Meta Tags -->
<title>Zenias | Digital Renaissance</title>
<meta name="title" content="Zenias | Digital Renaissance">
<meta name="description" content="Zenias - Bridging art and technology through innovative digital solutions. We create beautiful, functional experiences that transform how brands connect with their audience.">
<meta name="keywords" content="digital agency, web design, creative technology, AI systems, automation, governance, training">
<meta name="author" content="Zenias">
<meta name="robots" content="index, follow">
<meta name="language" content="English">

<!-- Open Graph / Facebook -->
<meta property="og:type" content="website">
<meta property="og:url" content="https://zenias.io/">
<meta property="og:title" content="Zenias | Digital Renaissance">
<meta property="og:description" content="Zenias - Bridging art and technology through innovative digital solutions. We create beautiful, functional experiences that transform how brands connect with their audience.">
<meta property="og:image" content="https://zenias.io/assets/images/No BG BLACK.png">

<!-- Twitter -->
<meta property="twitter:card" content="summary_large_image">
<meta property="twitter:url" content="https://zenias.io/">
<meta property="twitter:title" content="Zenias | Digital Renaissance">
<meta property="twitter:description" content="Zenias - Bridging art and technology through innovative digital solutions. We create beautiful, functional experiences that transform how brands connect with their audience.">
<meta property="twitter:image" content="https://zenias.io/assets/images/No BG BLACK.png">

<!-- Favicon -->
<link rel="icon" type="image/png" href="assets/images/No BG BLACK.png">
<link rel="apple-touch-icon" href="assets/images/No BG BLACK.png">

<!-- Canonical URL -->
<link rel="canonical" href="https://zenias.io/">

<meta name="view-transition" content="same-origin">

<!-- Speculation Rules (Chromium): prefetch/prerender Services for instant nav -->
<script type="speculationrules">
{
  "prefetch": [
    { "source": "list", "urls": ["services.html"] }
  ],
  "prerender": [
    { "source": "list", "urls": ["services.html"] }
  ]
}
</script>

<!-- DNS Prefetch for External Resources -->
<link rel="dns-prefetch" href="https://fonts.googleapis.com">
<link rel="dns-prefetch" href="https://fonts.gstatic.com">
<link rel="dns-prefetch" href="https://cdnjs.cloudflare.com">
<link rel="dns-prefetch" href="https://unpkg.com">
<link rel="dns-prefetch" href="https://images.unsplash.com">

<!-- Preload Critical Resources -->
<link rel="preload" href="css/output.css" as="style">
<link rel="preload" href="css/site.css" as="style">
<link rel="preload" href="js/site.js" as="script">
<link rel="preload" href="js/gsap/gsap.min.js" as="script">
<link rel="preload" href="assets/images/No BG BLACK.webp" as="image" type="image/webp">
<link rel="preload" href="assets/images/No BG BLACK.png" as="image" type="image/png">
<link rel="prefetch" href="services.html">

<!-- Fonts with Optimized Loading -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin=""> 
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;500;600&family=Inter:wght@200;300;400&family=JetBrains+Mono:wght@200;300;400&family=Open+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet" media="print" onload="this.media='all'">
<noscript><link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;500;600&family=Inter:wght@200;300;400&family=JetBrains+Mono:wght@200;300;400&family=Open+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet"></noscript>

<style>
  /* Avoid a brief fallback-font flash on the home hero headline reveal. */
  html:not(.fonts-ready) #hero-block,
  html:not(.fonts-ready) #mobile-hero-cta {
    opacity: 0 !important;
  }
  html:not(.fonts-ready) #hero-block.animate-fade-in,
  html:not(.fonts-ready) #mobile-hero-cta.animate-fade-in {
    animation: none !important;
  }
</style>

<script>
  (function () {
    function markFontsReady() {
      document.documentElement.classList.add('fonts-ready');
    }

    function whenFontsReady(timeoutMs) {
      const timeout = new Promise((resolve) => window.setTimeout(resolve, timeoutMs));
      if (document.fonts && typeof document.fonts.ready?.then === 'function') {
        return Promise.race([document.fonts.ready.catch(() => {}), timeout]);
      }
      return Promise.race([
        new Promise((resolve) => window.addEventListener('load', resolve, { once: true })),
        timeout,
      ]);
    }

    // Don’t block forever if fonts are slow/unavailable.
    whenFontsReady(2000).then(markFontsReady);
  })();
</script>

<!-- Tailwind CSS (Production Build) -->
<link rel="stylesheet" href="css/output.css">
<link rel="stylesheet" href="css/site.css">

<!-- External Libraries -->
<script src="js/gsap/gsap.min.js"></script>
<script src="https://unpkg.com/lucide@latest" defer></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js" defer></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.12.2/lottie.min.js" defer></script>
<script src="js/site.js" defer></script>

<script>
  // Animate-on-scroll helper
  (function () {
    const style = document.createElement("style");
    style.textContent = `
      .animate-on-scroll { animation-play-state: paused !important; }
      .animate-on-scroll.animate { animation-play-state: running !important; }
    `;
    document.head.appendChild(style);

    const once = true;
    if (!window.__inViewIO) {
      window.__inViewIO = new IntersectionObserver((entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            entry.target.classList.add("animate");
            if (once) window.__inViewIO.unobserve(entry.target);
          }
        });
      }, { threshold: 0.2, rootMargin: "0px 0px -10% 0px" });
    }

    window.initInViewAnimations = function (selector = ".animate-on-scroll") {
      document.querySelectorAll(selector).forEach((el) => {
        window.__inViewIO.observe(el);
      });
    };

    document.addEventListener("DOMContentLoaded", () => initInViewAnimations());
  })();
</script>
</head>

<body class="antialiased font-sans bg-paper h-screen">

    <!-- Subtle Grid Background -->
    <div class="absolute inset-0 pointer-events-none grid-overlay z-0"></div>

    <!-- Gradient Background Transition -->
    <div class="absolute inset-0 pointer-events-none z-[-1] bg-gradient-to-b from-paper from-10% via-paper via-25% to-[#e8e3db] to-40%"></div>

    <!-- Canvas -->
    <div id="canvas-container" class="absolute inset-0 z-1"></div>


    <!-- Header - Fixed across pages -->
    <header class="fixed top-0 left-0 right-0 z-50 flex justify-between items-center px-3 py-2 md:px-12 md:py-6 transition-all duration-300">
        <!-- Background Gradient & Blur with Soft Masked Edge -->
        <div class="absolute inset-x-0 top-0 h-32 md:h-48 bg-gradient-to-b from-paper via-paper/90 to-transparent backdrop-blur-md -z-10 pointer-events-none [mask-image:linear-gradient(to_bottom,black_20%,transparent_90%)]"></div>

        <a href="index.html" class="flex items-center gap-2 md:gap-4 cursor-pointer" id="logo-home" aria-label="Zenias home">
            <div class="w-8 h-8 md:w-10 md:h-10 border border-neutral-800 flex items-center justify-center rounded-sm bg-paper relative overflow-hidden">
                <img src="assets/images/No BG BLACK.png" alt="Z Logo" class="w-6 h-6 md:w-8 md:h-8 object-contain" loading="eager" fetchpriority="high" id="logo-img">
            </div>
            <span class="font-serif text-2xl md:text-4xl tracking-tight text-ink font-medium">Zenias</span>
        </a>

        <nav class="hidden md:flex items-center gap-10">
            <a href="services.html" id="nav-services" class="font-mono text-xs text-neutral-500 hover:text-ink transition-colors tracking-widest uppercase">Services</a>
            <a href="works.html" id="nav-works" class="font-mono text-xs text-neutral-500 hover:text-ink transition-colors tracking-widest uppercase">Works</a>
            <a href="about-us.html" id="nav-about" class="font-mono text-xs text-neutral-500 hover:text-ink transition-colors tracking-widest uppercase">About Us</a>
            <a id="nav-inquire" href="inquire.html" class="font-serif italic text-lg px-8 py-2 border border-transparent bg-sepia hover:bg-ink transition-colors text-paper rounded-full shadow-sm">Inquire</a>
        </nav>

        <!-- Mobile Menu Toggle -->
        <button id="mobile-menu-btn" class="md:hidden w-8 h-8 flex items-center justify-center" aria-label="Toggle menu"></button>

        <!-- Mobile Menu Overlay -->
        <div id="mobile-menu" class="absolute top-14 right-3 md:top-24 md:right-6 flex flex-col items-end gap-3 md:gap-4 md:hidden pointer-events-auto transition-all duration-300 opacity-0 translate-y-[-10px] invisible z-[60]">
            <a href="services.html" id="mobile-services" class="font-serif text-xl text-ink hover:text-sepia transition-colors">Services</a>
            <a href="works.html" id="mobile-works" class="font-serif text-xl text-ink hover:text-sepia transition-colors">Works</a>
            <a href="about-us.html" id="mobile-about" class="font-serif text-xl text-ink hover:text-sepia transition-colors">About Us</a>
            <a id="mobile-inquire" href="inquire.html" class="font-serif italic text-lg px-6 py-1 border border-transparent bg-sepia text-paper rounded-full">Inquire</a>
        </div>
    </header>


<main class="absolute inset-0 z-20 pointer-events-none p-6 md:p-12 h-full w-full">
        <div id="home-page" class="relative h-full w-full">
            <!-- Header removed from here -->

            <!-- Hero Text -->
            <div id="hero-block" class="absolute top-16 left-4 right-4 md:relative md:top-auto md:left-auto md:right-auto md:mt-[10vh] z-20 w-full max-w-4xl animate-fade-in opacity-0" style="animation-delay: 0.3s;">
                <div class="hero-kicker-row flex flex-wrap md:flex-nowrap items-center gap-3 mb-4 md:mb-6">
                    <div class="hidden md:block h-px w-8 md:w-12 bg-rust"></div>
                    <span class="hero-kicker min-w-0 font-mono text-[8px] md:text-xs text-rust uppercase tracking-[0.15em] md:tracking-[0.2em] max-w-full overflow-hidden">Development | Training | Consulting | Governance</span>
                </div>
                
                <!-- Title - Bigger on mobile -->
                <h1 class="hero-title font-serif text-7xl md:text-8xl lg:text-9xl text-ink leading-[0.85] tracking-tighter mix-blend-multiply">
                    Build your<br>
                    <span class="italic font-light text-neutral-600">Next.</span>
                </h1>
                
                <!-- Desktop only: Description and CTA inline -->
                <p class="home-hero-subtext hidden md:block mt-8 max-w-md font-sans text-lg text-neutral-700 font-normal leading-relaxed">
                    We design secure AI-enabled systems, and teach the forward-thinking to master them.
                </p>

                <div class="hidden md:flex mt-10 items-center gap-4 pointer-events-auto">
                    <button id="btn-start-desktop" class="group flex items-center gap-3 bg-sepia text-paper pl-6 pr-5 py-3 rounded-sm hover:bg-ink transition-all duration-500">
                        <span class="font-mono text-xs tracking-widest uppercase">Start</span>
                        <i data-lucide="arrow-right" class="w-4 h-4 group-hover:translate-x-1 transition-transform"></i>
                    </button>
                    <div class="h-px w-16 bg-neutral-300"></div>
                    <span class="font-serif italic text-neutral-400 text-sm">v.4.2.0</span>
                </div>
            </div>

            <!-- Mobile only: Bottom section with description and CTA -->
            <div id="mobile-hero-cta" class="absolute bottom-8 left-6 right-6 z-20 md:hidden animate-fade-in opacity-0 pointer-events-auto" style="animation-delay: 0.5s;">
                <p class="home-hero-subtext max-w-xs font-sans text-sm text-neutral-700 font-normal leading-relaxed mb-6">
                    We design secure AI-enabled systems, and teach the forward-thinking to master them.
                </p>

                <div class="flex items-center gap-4">
                    <button id="btn-start-mobile" class="group flex items-center gap-3 bg-sepia text-paper pl-6 pr-5 py-3 rounded-sm hover:bg-ink transition-all duration-500">
                        <span class="font-mono text-xs tracking-widest uppercase">Start</span>
                        <i data-lucide="arrow-right" class="w-4 h-4 group-hover:translate-x-1 transition-transform"></i>
                    </button>
                    <div class="h-px w-12 bg-neutral-300"></div>
                    <span class="font-serif italic text-neutral-400 text-sm">v.4.2.0</span>
                </div>
            </div>

            <!-- Footer Coordinates - Perth Global visible on all, Lat/Lon desktop only -->
            <div id="hero-coordinates" class="absolute bottom-40 md:bottom-32 left-6 md:left-0 flex flex-col gap-1 z-10">
                <span class="hero-perth-global font-mono text-[12px] text-neutral-600 uppercase tracking-widest mb-1 opacity-70">Perth | Global</span>
                <div class="hidden md:flex flex-col opacity-40">
                    <span class="font-mono text-[11px] text-neutral-400">LAT: 31.9514° S</span>
                    <span class="font-mono text-[11px] text-neutral-400">LON: 115.8617° E</span>
                </div>
            </div>
        </div>
    </main>
    
    <!-- Transition Loader -->
    <div id="transition-loader" class="fixed inset-0 z-[100] flex items-center justify-center pointer-events-none opacity-0">
        <div class="relative flex flex-col items-center">
            <!-- Cool element: Orbiting circles that mimic the orb's logic -->
            <div class="loader-visual relative w-32 h-32 mb-8">
                <div class="absolute inset-0 border border-sepia/20 rounded-full"></div>
                <div class="absolute inset-2 border border-sepia/40 rounded-full"></div>
                <div class="absolute inset-4 border border-sepia/10 rounded-full"></div>
                <!-- Central dot -->
                <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-1.5 h-1.5 bg-sepia rounded-full shadow-[0_0_15px_rgba(120,53,15,0.5)]"></div>
            </div>
            <div class="loader-text font-serif italic text-3xl text-ink tracking-[0.2em] ml-2">Welcome...</div>
        </div>
    </div>

<!-- Shaders -->
    <script type="x-shader/x-vertex" id="vertexShader">
        uniform float uTime;
        uniform float uDistortion; 
        uniform float uSize;       
        uniform vec2 uMouse;

        varying float vAlpha;
        varying vec3 vPos;
        varying float vNoise;

        // Simplex Noise (Standard implementation)
        vec3 mod289(vec3 x) { return x - floor(x * (1.0 / 289.0)) * 289.0; }
        vec4 mod289(vec4 x) { return x - floor(x * (1.0 / 289.0)) * 289.0; }
        vec4 permute(vec4 x) { return mod289(((x*34.0)+1.0)*x); }
        vec4 taylorInvSqrt(vec4 r) { return 1.79284291400159 - 0.85373472095314 * r; }
        
        float snoise(vec3 v) {
            const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;
            const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);
            vec3 i  = floor(v + dot(v, C.yyy) );
            vec3 x0 = v - i + dot(i, C.xxx) ;
            vec3 g = step(x0.yzx, x0.xyz);
            vec3 l = 1.0 - g;
            vec3 i1 = min( g.xyz, l.zxy );
            vec3 i2 = max( g.xyz, l.zxy );
            vec3 x1 = x0 - i1 + 1.0 * C.xxx;
            vec3 x2 = x0 - i2 + 2.0 * C.xxx;
            vec3 x3 = x0 - 1.0 + 3.0 * C.xxx;
            i = mod289(i);
            vec4 p = permute( permute( permute(
                        i.z + vec4(0.0, i1.z, i2.z, 1.0 ))
                    + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))
                    + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));
            float n_ = 1.0/7.0;
            vec3  ns = n_ * D.wyz - D.xzx;
            vec4 j = p - 49.0 * floor(p * ns.z *ns.z);
            vec4 x_ = floor(j * ns.z);
            vec4 y_ = floor(j - 7.0 * x_ );
            vec4 x = x_ *ns.x + ns.yyyy;
            vec4 y = y_ *ns.x + ns.yyyy;
            vec4 h = 1.0 - abs(x) - abs(y);
            vec4 b0 = vec4( x.xy, y.xy );
            vec4 b1 = vec4( x.zw, y.zw );
            vec4 s0 = floor(b0)*2.0 + 1.0;
            vec4 s1 = floor(b1)*2.0 + 1.0;
            vec4 sh = -step(h, vec4(0.0));
            vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;
            vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;
            vec3 p0 = vec3(a0.xy,h.x);
            vec3 p1 = vec3(a0.zw,h.y);
            vec3 p2 = vec3(a1.xy,h.z);
            vec3 p3 = vec3(a1.zw,h.w);
            vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
            p0 *= norm.x; p1 *= norm.y; p2 *= norm.z; p3 *= norm.w;
            vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);
            m = m * m;
            return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), dot(p2,x2), dot(p3,x3) ) );
        }

        void main() {
            vec3 pos = position;
            
            // Smoother, more organic noise (Liquid/Ink feel)
            float noiseFreq = 0.5;
            float noiseAmp = uDistortion;
            float noise = snoise(vec3(pos.x * noiseFreq + uTime * 0.1, pos.y * noiseFreq, pos.z * noiseFreq));
            
            vNoise = noise;
            
            // Deform the sphere along normal based on noise
            vec3 newPos = pos + (normalize(pos) * noise * noiseAmp);

            // Interaction
            float dist = distance(uMouse * 10.0, newPos.xy);
            float interaction = smoothstep(5.0, 0.0, dist);
            newPos += normalize(pos) * interaction * 0.5;

            vec4 mvPosition = modelViewMatrix * vec4(newPos, 1.0);
            gl_Position = projectionMatrix * mvPosition;

            // Size variation based on depth and noise
            gl_PointSize = uSize * (24.0 / -mvPosition.z) * (1.0 + noise * 0.5);
            
            vAlpha = 1.0;
            vPos = newPos;
        }
    </script>

    <script type="x-shader/x-fragment" id="fragmentShader">
        uniform vec3 uColor;
        uniform float uOpacity;
        
        varying float vNoise;
        varying vec3 vPos;

        void main() {
            // Soft circle particle
            vec2 center = gl_PointCoord - vec2(0.5);
            float dist = length(center);
            if (dist > 0.5) discard;
            
            // Soft edges for "ink blot" effect
            float alpha = smoothstep(0.5, 0.2, dist) * uOpacity;
            
            // Color variation based on noise (creates depth)
            vec3 darkColor = uColor * 0.5;
            vec3 lightColor = uColor * 1.8; // Highlights
            
            vec3 finalColor = mix(darkColor, lightColor, vNoise * 0.5 + 0.5);
            
            gl_FragColor = vec4(finalColor, alpha);
        }
    </script>


<script>
// Declare variables in outer scope so they can be accessed by GSAP animations
        let uniforms, transitionRotationY, systemsGroup, particles, camera, renderer, scene;

        // Wait for THREE.js to load before initializing canvas
        function initThreeJS() {
            if (!window.THREE) {
                // Try again after a short delay
                setTimeout(initThreeJS, 100);
                return;
            }

        const container = document.getElementById('canvas-container');
        if (!container) return; // Exit if container doesn't exist
        
        scene = new THREE.Scene();
        // Fog to blend into paper background
        scene.fog = new THREE.FogExp2(0xCECECE, 0.035);

        camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 0.1, 100);
        camera.position.set(0, 0, 18);

        renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        container.appendChild(renderer.domElement);

        // Group to hold the "Systems"
        systemsGroup = new THREE.Group();
        systemsGroup.position.x = 4.0; 
        scene.add(systemsGroup);

        // --- MAIN PARTICLE MESH (The "Brain/Cloud") ---
        // Dense geometry for ink effect
        const geometry = new THREE.IcosahedronGeometry(4.5, 30);
        
        uniforms = {
            uTime: { value: 0 },
            uDistortion: { value: 0.6 },
            uSize: { value: 2.5 },
            uColor: { value: new THREE.Color('#4A1D0A') }, // Dark Red
            uOpacity: { value: 0.8 },
            uMouse: { value: new THREE.Vector2(0, 0) }
        };

        const material = new THREE.ShaderMaterial({
            vertexShader: document.getElementById('vertexShader').textContent,
            fragmentShader: document.getElementById('fragmentShader').textContent,
            uniforms: uniforms,
            transparent: true,
            depthWrite: false,
            // Additive blending makes it look too digital/glowing. 
            // Normal blending is better for ink/physical matter.
            blending: THREE.NormalBlending
        });

        particles = new THREE.Points(geometry, material);
        systemsGroup.add(particles);

        // --- RENAISSANCE LINES (Astrolabe effect) ---
        const lineGroup = new THREE.Group();
        systemsGroup.add(lineGroup);

        function createThinOrbit(radius, rotation, phase = 0) {
            const curve = new THREE.EllipseCurve(
                0, 0,            // ax, aY
                radius, radius,  // xRadius, yRadius
                0, 2 * Math.PI,  // aStartAngle, aEndAngle
                false,           // aClockwise
                0                // aRotation
            );
            const points = curve.getPoints(128);
            const geo = new THREE.BufferGeometry().setFromPoints(points);

            // Rust ↔ Purple vertex color blend for better visibility
            const rust = new THREE.Color(0x9A3412);
            const purple = new THREE.Color(0x5B21B6);
            const colors = [];
            const count = points.length;
            for (let i = 0; i < count; i++) {
                const t = count <= 1 ? 0 : i / (count - 1);
                const mix = (Math.sin((t + phase) * Math.PI * 2) + 1) * 0.5;
                const c = rust.clone().lerp(purple, mix);
                colors.push(c.r, c.g, c.b);
            }
            geo.setAttribute('color', new THREE.Float32BufferAttribute(colors, 3));

            const mat = new THREE.LineBasicMaterial({ 
                vertexColors: true,
                transparent: true,
                opacity: 0.38,
                fog: false,
                depthWrite: false
            });
            const orbit = new THREE.Line(geo, mat);
            orbit.rotation.x = rotation.x;
            orbit.rotation.y = rotation.y;
            lineGroup.add(orbit);
            return orbit;
        }

        const orbits = [
            createThinOrbit(5.5, {x: Math.PI/2, y: 0}, 0.0),
            createThinOrbit(5.2, {x: Math.PI/3, y: Math.PI/6}, 0.33),
            createThinOrbit(6.0, {x: Math.PI/1.8, y: Math.PI/4}, 0.66)
        ];

        // --- INTERACTION & ANIMATION ---
        let time = 0;
        let speed = 0.1;
        let mouseX = 0, mouseY = 0;
        transitionRotationY = { value: 0 };

        // New Interaction State
        let isDragging = false;
        let previousMouse = { x: 0, y: 0 };
        let rotationVelocity = { x: 0, y: 0 };
        let cumulativeRotation = { x: 0, y: 0 };

        document.addEventListener('mousemove', (e) => {
            mouseX = (e.clientX / window.innerWidth) * 2 - 1;
            mouseY = -(e.clientY / window.innerHeight) * 2 + 1;
            uniforms.uMouse.value.x += (mouseX - uniforms.uMouse.value.x) * 0.05;
            uniforms.uMouse.value.y += (mouseY - uniforms.uMouse.value.y) * 0.05;
        });

        // Drag Events (Mouse)
        document.addEventListener('mousedown', (e) => {
            isDragging = true;
            previousMouse = { x: e.clientX, y: e.clientY };
            rotationVelocity = { x: 0, y: 0 }; // Reset velocity on grab
        });

        document.addEventListener('mousemove', (e) => {
            if (isDragging) {
                const deltaX = e.clientX - previousMouse.x;
                const deltaY = e.clientY - previousMouse.y;
                
                // Update velocity based on drag speed
                rotationVelocity.x = deltaY * 0.005; // Drag Y controls X rotation
                rotationVelocity.y = deltaX * 0.005; // Drag X controls Y rotation
                
                cumulativeRotation.x += rotationVelocity.x;
                cumulativeRotation.y += rotationVelocity.y;
                
                previousMouse = { x: e.clientX, y: e.clientY };
            }
        });

        document.addEventListener('mouseup', () => {
            isDragging = false;
        });

        // Drag Events (Touch)
        document.addEventListener('touchstart', (e) => {
            isDragging = true;
            previousMouse = { x: e.touches[0].clientX, y: e.touches[0].clientY };
            rotationVelocity = { x: 0, y: 0 };
        }, { passive: false });

        document.addEventListener('touchmove', (e) => {
            if (isDragging) {
                const deltaX = e.touches[0].clientX - previousMouse.x;
                const deltaY = e.touches[0].clientY - previousMouse.y;
                
                rotationVelocity.x = deltaY * 0.005;
                rotationVelocity.y = deltaX * 0.005;
                
                cumulativeRotation.x += rotationVelocity.x;
                cumulativeRotation.y += rotationVelocity.y;
                
                previousMouse = { x: e.touches[0].clientX, y: e.touches[0].clientY };
            }
        }, { passive: false });

        document.addEventListener('touchend', () => {
            isDragging = false;
        });

        // Resize
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
            adjustLayout();
        });

        function adjustLayout() {
            // Mobile: Move group down so it doesn't block top text, slightly smaller
            if(window.innerWidth < 768) {
                systemsGroup.position.set(0, -1.0, -5);
                systemsGroup.scale.set(0.75, 0.75, 0.75);
            } else {
                systemsGroup.position.set(4.5, 0, 0);
                systemsGroup.scale.set(1, 1, 1);
            }
        }
        adjustLayout();
        
        // Ensure initial orb state is set correctly
        if (systemsGroup) {
            const isMobile = window.innerWidth < 768;
            if (isMobile) {
                systemsGroup.position.set(0, -1.0, -5);
                systemsGroup.scale.set(0.75, 0.75, 0.75);
            } else {
                systemsGroup.position.set(4.5, 0, 0);
                systemsGroup.scale.set(1, 1, 1);
            }
            transitionRotationY.value = 0;
        }

        function animate() {
            requestAnimationFrame(animate);
            
            // Base time progression
            time += 0.01 + (speed * 0.05);

            if (!isDragging) {
                // Apply momentum damping
                rotationVelocity.x *= 0.95;
                rotationVelocity.y *= 0.95;
                
                // Return to base rotation speed gradually
                const baseSpeed = 0.005; // Increased idle rotation speed
                
                // Ease Y rotation to base speed
                rotationVelocity.y += (baseSpeed - rotationVelocity.y) * 0.02;
                
                // Dampen X rotation to 0
                if (Math.abs(rotationVelocity.x) < 0.0001) rotationVelocity.x = 0;
                
                cumulativeRotation.x += rotationVelocity.x;
                cumulativeRotation.y += rotationVelocity.y;
            }

            // Apply calculated rotation
            // We ADD existing transitionRotationY logic (scrolling)
            systemsGroup.rotation.x = cumulativeRotation.x;
            systemsGroup.rotation.y = cumulativeRotation.y + transitionRotationY.value;
            
            // Subtle Z wobble
            systemsGroup.rotation.z = Math.sin(time * 0.1) * 0.05;

            // Counter-rotate orbits
            lineGroup.rotation.x = Math.sin(time * 0.05) * 0.2;
            orbits.forEach((orbit, i) => {
                orbit.rotation.z += 0.002 * (i + 1);
            });

            // Smooth camera sway based on mouse
            camera.position.x += (mouseX * 0.5 - camera.position.x) * 0.05;
            camera.position.y += (mouseY * 0.5 - camera.position.y) * 0.05;
            camera.lookAt(0,0,0);

            uniforms.uTime.value = time;
            renderer.render(scene, camera);
        }
        animate();
        }

        // Initialize Three.js when ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initThreeJS);
        } else {
            initThreeJS();
        }

        

// Home-only: Start button plays orb exit then navigates to Services
(() => {
  const heroBlock = document.getElementById('hero-block');
  const btnStartDesktop = document.getElementById('btn-start-desktop');
  const btnStartMobile = document.getElementById('btn-start-mobile');
  const navServices = document.getElementById('nav-services');
  const mobileServices = document.getElementById('mobile-services');

  // Aggressive Prefetching
  let hasPrefetchedServices = false;
  const prefetchServices = () => {
    if (hasPrefetchedServices) return;
    hasPrefetchedServices = true;
    try {
      const link = document.createElement('link');
      link.rel = 'prefetch';
      link.href = 'services.html';
      link.as = 'document';
      document.head.appendChild(link);
    } catch (_) {}

    // Kick off the request and let it overlap with the orb animation.
    // (This is the "overlap navigation" you want, without cutting the orb short.)
    fetch('services.html', { cache: 'force-cache', credentials: 'same-origin' }).catch(() => {});
  };
  
  window.addEventListener('load', prefetchServices);

  let isAnimating = false;
  let hasNavigated = false;

  function redirectToServices() {
    if (hasNavigated) return;
    hasNavigated = true;
    window.location.href = 'services.html';
  }

  function goToServices() {
    if (isAnimating) return;
    isAnimating = true;

    // Start fetching immediately so network work overlaps the orb timeline.
    prefetchServices();

    if (typeof gsap === 'undefined') {
      redirectToServices();
      return;
    }

    // Get all foreground elements to fade out
    const header = document.querySelector('header');
    const mobileHeroCta = document.getElementById('mobile-hero-cta');
    const heroCoordinates = document.getElementById('hero-coordinates');

    // Clear CSS animations so GSAP can take over
    [heroBlock, header, mobileHeroCta, heroCoordinates].forEach(el => {
      if (el) {
        const currentOpacity = getComputedStyle(el).opacity; // Capture BEFORE removing animation
        el.style.animation = 'none';
        el.style.opacity = currentOpacity;
      }
    });

    const tl = gsap.timeline({
      defaults: { ease: 'power2.inOut' },
      onComplete: () => {
        setTimeout(redirectToServices, 500);
      },
    });

    // Fade out hero block with upward motion
    if (heroBlock) {
      tl.to(heroBlock, { opacity: 0, y: -40, duration: 0.8 }, 0);
    }

    // Fade out header
    if (header) {
      tl.to(header, { opacity: 0, duration: 0.6 }, 0);
    }

    // Fade out mobile CTA section
    if (mobileHeroCta) {
      tl.to(mobileHeroCta, { opacity: 0, duration: 0.6 }, 0.1);
    }

    // Fade out coordinates
    if (heroCoordinates) {
      tl.to(heroCoordinates, { opacity: 0, duration: 0.6 }, 0.1);
    }

    // Fade body to Services background color
    tl.to(document.body, { backgroundColor: '#FDFCF8', duration: 1.5 }, 0.5);

    // Orb exit animation (Slower, more cinematic)
    if (typeof uniforms !== 'undefined' && uniforms && systemsGroup && transitionRotationY) {
      // Position loader based on layout
      const loader = document.getElementById('transition-loader');
      if (loader) {
        const isMobile = window.innerWidth < 768;
        const loaderContent = loader.querySelector('div');
        if (loaderContent) {
          if (isMobile) {
            loaderContent.style.transform = 'translateY(10vh)';
          } else {
            loaderContent.style.marginLeft = '25%';
          }
        }
      }

      tl.to(uniforms.uOpacity, { value: 0, duration: 2.5 }, 0);
      tl.to(transitionRotationY, { value: transitionRotationY.value + Math.PI * 3, duration: 3.5 }, 0);
      tl.to(systemsGroup.scale, { x: 5.0, y: 5.0, z: 5.0, duration: 3.5 }, 0);
      tl.to(systemsGroup.position, { z: 15, duration: 3.5 }, 0);
      
      // Fade in the loader as the orb finishes
      tl.to('#transition-loader', { 
        opacity: 1, 
        duration: 1.5, 
        pointerEvents: 'auto' 
      }, 2.0);
      
      // Scale the loader up
      tl.fromTo('#transition-loader .loader-visual', 
        { scale: 0.8, opacity: 0 },
        { scale: 1, opacity: 1, duration: 1.5, ease: 'back.out(1.7)' }, 
        2.2
      );
    } else {
      tl.add(redirectToServices, 0.1);
    }
  }

  // Also prefetch on hover
  btnStartDesktop?.addEventListener('mouseenter', prefetchServices);
  btnStartMobile?.addEventListener('mouseenter', prefetchServices);
  navServices?.addEventListener('mouseenter', prefetchServices);
  mobileServices?.addEventListener('mouseenter', prefetchServices);

  btnStartDesktop?.addEventListener('click', (e) => { e.preventDefault(); goToServices(); });
  btnStartMobile?.addEventListener('click', (e) => { e.preventDefault(); goToServices(); });
  navServices?.addEventListener('click', (e) => { e.preventDefault(); goToServices(); });
  mobileServices?.addEventListener('click', (e) => { e.preventDefault(); goToServices(); });
})();
</script>


</body>
</html>

/* Auto-generated from index.html (menuAnimationData extracted). */

(function () {
  'use strict';

  const menuAnimationData = {"v":"5.4.4","fr":60,"ip":0,"op":140,"w":100,"h":100,"nm":"Menu","ddd":0,"assets":[],"layers":[{"ddd":0,"ind":1,"ty":4,"nm":"Buttom","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":1,"k":[{"i":{"x":[0.667],"y":[1]},"o":{"x":[0.333],"y":[0]},"t":40,"s":[0],"e":[-45]},{"i":{"x":[0.667],"y":[1]},"o":{"x":[0.333],"y":[0]},"t":60,"s":[-45],"e":[-45]},{"i":{"x":[0.667],"y":[1]},"o":{"x":[0.333],"y":[0]},"t":85,"s":[-45],"e":[0]},{"t":105}],"ix":10},"p":{"a":1,"k":[{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"t":10,"s":[51,70,0],"e":[51,78,0],"to":[0,1.333,0],"ti":[0,3.333,0]},{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"t":23,"s":[51,78,0],"e":[51,50,0],"to":[0,-3.333,0],"ti":[0,4.667,0]},{"i":{"x":0.833,"y":0.833},"o":{"x":0.167,"y":0.167},"t":36,"s":[51,50,0],"e":[51,50,0],"to":[0,0,0],"ti":[0,0,0]},{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"t":110,"s":[51,50,0],"e":[51,78,0],"to":[0,4.667,0],"ti":[0,-3.333,0]},{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"t":123,"s":[51,78,0],"e":[51,70,0],"to":[0,3.333,0],"ti":[0,1.333,0]},{"t":136}],"ix":2},"a":{"a":0,"k":[0,0,0],"ix":1},"s":{"a":0,"k":[100,100,100],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"ty":"rc","d":1,"s":{"a":0,"k":[31,4],"ix":2},"p":{"a":0,"k":[0,0],"ix":3},"r":{"a":0,"k":2,"ix":4},"nm":"Rectangle Path 1","mn":"ADBE Vector Shape - Rect","hd":false},{"ty":"fl","c":{"a":0,"k":[0.20000000298,0.20000000298,0.20000000298,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[0,0],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[200,200],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Buttom","np":2,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":331,"st":0,"bm":0},{"ddd":0,"ind":2,"ty":4,"nm":"Center","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":1,"k":[{"i":{"x":[0.667],"y":[1]},"o":{"x":[0.333],"y":[0]},"t":40,"s":[0],"e":[45]},{"i":{"x":[0.667],"y":[1]},"o":{"x":[0.333],"y":[0]},"t":60,"s":[45],"e":[45]},{"i":{"x":[0.667],"y":[1]},"o":{"x":[0.333],"y":[0]},"t":85,"s":[45],"e":[0]},{"t":105}],"ix":10},"p":{"a":0,"k":[51,50,0],"ix":2},"a":{"a":0,"k":[0,0,0],"ix":1},"s":{"a":0,"k":[100,100,100],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"ty":"rc","d":1,"s":{"a":0,"k":[31,4],"ix":2},"p":{"a":0,"k":[0,0],"ix":3},"r":{"a":0,"k":2,"ix":4},"nm":"Rectangle Path 1","mn":"ADBE Vector Shape - Rect","hd":false},{"ty":"fl","c":{"a":0,"k":[0.20000000298,0.20000000298,0.20000000298,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[0,0],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[200,200],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Center","np":2,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":331,"st":0,"bm":0},{"ddd":0,"ind":3,"ty":4,"nm":"Upper","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":1,"k":[{"i":{"x":[0.667],"y":[1]},"o":{"x":[0.333],"y":[0]},"t":40,"s":[0],"e":[-45]},{"i":{"x":[0.667],"y":[1]},"o":{"x":[0.333],"y":[0]},"t":60,"s":[-45],"e":[-45]},{"i":{"x":[0.667],"y":[1]},"o":{"x":[0.333],"y":[0]},"t":85,"s":[-45],"e":[0]},{"t":105}],"ix":10},"p":{"a":1,"k":[{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"t":10,"s":[51,30,0],"e":[51,22,0],"to":[0,-1.333,0],"ti":[0,-3.333,0]},{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"t":23,"s":[51,22,0],"e":[51,50,0],"to":[0,3.333,0],"ti":[0,-4.667,0]},{"i":{"x":0.831,"y":0.831},"o":{"x":0.165,"y":0.165},"t":36,"s":[51,50,0],"e":[51,50,0],"to":[0,0,0],"ti":[0,0,0]},{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"t":110,"s":[51,50,0],"e":[51,22,0],"to":[0,-4.667,0],"ti":[0,3.333,0]},{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"t":123,"s":[51,22,0],"e":[51,30,0],"to":[0,-3.333,0],"ti":[0,-1.333,0]},{"t":136}],"ix":2},"a":{"a":0,"k":[0,0,0],"ix":1},"s":{"a":0,"k":[100,100,100],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"ty":"rc","d":1,"s":{"a":0,"k":[31,4],"ix":2},"p":{"a":0,"k":[0,0],"ix":3},"r":{"a":0,"k":2,"ix":4},"nm":"Rectangle Path 1","mn":"ADBE Vector Shape - Rect","hd":false},{"ty":"fl","c":{"a":0,"k":[0.20000000298,0.20000000298,0.20000000298,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[0,0],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[200,200],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Upper","np":2,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":331,"st":0,"bm":0}],"markers":[]};

  function initLucideIcons() {
    const create = () => {
      if (window.lucide && typeof window.lucide.createIcons === 'function') {
        window.lucide.createIcons();
      }
    };

    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', create, { once: true });
    } else {
      create();
    }

    window.addEventListener('load', create, { once: true });
  }

  function supportsWebP() {
    try {
      const canvas = document.createElement('canvas');
      canvas.width = 1;
      canvas.height = 1;
      return canvas.toDataURL('image/webp').indexOf('data:image/webp') === 0;
    } catch (_) {
      return false;
    }
  }

  function initLazyAssets() {
    const webpSupported = supportsWebP();

    // Swap logo to WebP if supported.
    const logoImg = document.getElementById('logo-img');
    if (logoImg && webpSupported) {
      logoImg.src = 'assets/images/No BG BLACK.webp';
      logoImg.onerror = function () {
        this.onerror = null;
        this.src = 'assets/images/No BG BLACK.png';
      };
    }

    const getBgUrl = (el) => {
      if (!el) return null;
      if (webpSupported && el.getAttribute('data-bg-webp')) return el.getAttribute('data-bg-webp');
      if (el.getAttribute('data-bg-fallback')) return el.getAttribute('data-bg-fallback');
      if (el.getAttribute('data-bg')) return el.getAttribute('data-bg');
      return null;
    };

    const applyBg = (el) => {
      const bgUrl = getBgUrl(el);
      if (!bgUrl) return;
      el.style.backgroundImage = `url('${bgUrl}')`;
      el.setAttribute('data-loaded', 'true');
      el.classList.remove('lazy-bg');
    };

    const lazyEls = Array.from(document.querySelectorAll('.lazy-bg'));
    if (!lazyEls.length) return;

    if ('IntersectionObserver' in window) {
      const io = new IntersectionObserver((entries, observer) => {
        entries.forEach((entry) => {
          if (!entry.isIntersecting) return;
          applyBg(entry.target);
          observer.unobserve(entry.target);
        });
      }, { rootMargin: '50px' });

      lazyEls.forEach((el) => io.observe(el));

      // Also eagerly load anything already in view.
      setTimeout(() => {
        lazyEls.filter((el) => !el.hasAttribute('data-loaded')).forEach((el) => applyBg(el));
      }, 100);
    } else {
      lazyEls.forEach((el) => applyBg(el));
    }
  }

  function initMobileMenu() {
    const mobileMenuBtn = document.getElementById('mobile-menu-btn');
    const mobileMenu = document.getElementById('mobile-menu');
    if (!mobileMenuBtn || !mobileMenu) return;

    let isMenuOpen = false;
    let menuTimeout = null;
    let menuAnim = null;

    function openMenu() {
      if (menuTimeout) {
        clearTimeout(menuTimeout);
        menuTimeout = null;
      }

      isMenuOpen = true;
      mobileMenu.classList.remove('invisible', 'opacity-0', 'translate-y-[-10px]');
      mobileMenu.classList.add('opacity-100', 'translate-y-0');
      if (menuAnim && typeof menuAnim.playSegments === 'function') {
        menuAnim.playSegments([0, 60], true);
      }
    }

    function closeMenu() {
      if (menuTimeout) {
        clearTimeout(menuTimeout);
        menuTimeout = null;
      }

      isMenuOpen = false;
      mobileMenu.classList.add('opacity-0', 'translate-y-[-10px]');
      mobileMenu.classList.remove('opacity-100', 'translate-y-0');
      menuTimeout = window.setTimeout(() => {
        mobileMenu.classList.add('invisible');
        menuTimeout = null;
      }, 300);

      if (menuAnim && typeof menuAnim.playSegments === 'function') {
        menuAnim.playSegments([85, 140], true);
      }
    }

    function toggleMenu() {
      if (isMenuOpen) closeMenu();
      else openMenu();
    }

    mobileMenuBtn.addEventListener('click', (e) => {
      e.preventDefault();
      toggleMenu();
    });

    // Expose for page scripts if needed.
    window.toggleMenu = toggleMenu;

    function initMenuLottie() {
      if (!window.lottie) {
        window.addEventListener('load', initMenuLottie, { once: true });
        return;
      }

      try {
        menuAnim = window.lottie.loadAnimation({
          container: mobileMenuBtn,
          renderer: 'svg',
          loop: false,
          autoplay: false,
          animationData: menuAnimationData,
        });

        if (menuAnim && typeof menuAnim.setSpeed === 'function') menuAnim.setSpeed(1.5);
        if (menuAnim && typeof menuAnim.goToAndStop === 'function') menuAnim.goToAndStop(0, true);
      } catch (err) {
        // Non-fatal.
        console.warn('Menu Lottie init failed:', err);
      }
    }

    initMenuLottie();
  }

  // Boot
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', () => {
      initLucideIcons();
      initLazyAssets();
      initMobileMenu();
    }, { once: true });
  } else {
    initLucideIcons();
    initLazyAssets();
    initMobileMenu();
  }
})();
